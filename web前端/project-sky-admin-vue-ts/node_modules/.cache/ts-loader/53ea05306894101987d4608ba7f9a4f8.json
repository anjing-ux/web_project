{"remainingRequest":"G:\\sky\\project-sky-admin-vue-ts\\node_modules\\thread-loader\\dist\\cjs.js!G:\\sky\\project-sky-admin-vue-ts\\node_modules\\babel-loader\\lib\\index.js!G:\\sky\\project-sky-admin-vue-ts\\node_modules\\ts-loader\\index.js??ref--13-3!G:\\sky\\project-sky-admin-vue-ts\\src\\store\\modules\\user.ts","dependencies":[{"path":"G:\\sky\\project-sky-admin-vue-ts\\src\\store\\modules\\user.ts","mtime":1652756116000},{"path":"G:\\sky\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\sky\\project-sky-admin-vue-ts\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\sky\\project-sky-admin-vue-ts\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"G:\\sky\\project-sky-admin-vue-ts\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"G:\\\\sky\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"G:\\\\sky\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\nimport _classCallCheck from \"G:\\\\sky\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"G:\\\\sky\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"G:\\\\sky\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"G:\\\\sky\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"G:\\\\sky\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/inherits\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { __decorate } from \"tslib\";\nimport { VuexModule, Module, Action, Mutation, getModule } from 'vuex-module-decorators';\nimport { login, userLogout } from '@/api/employee';\nimport { getToken, setToken, removeToken, getStoreId, setStoreId, getUserInfo, removeUserInfo } from '@/utils/cookies';\nimport store from '@/store';\nimport Cookies from 'js-cookie';\nimport { Message } from 'element-ui';\n\nvar User =\n/*#__PURE__*/\nfunction (_VuexModule) {\n  _inherits(User, _VuexModule);\n\n  function User() {\n    var _this;\n\n    _classCallCheck(this, User);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(User).apply(this, arguments));\n    _this.token = getToken() || '';\n    _this.name = '';\n    _this.avatar = ''; // @ts-ignore\n\n    _this.storeId = getStoreId() || '';\n    _this.introduction = '';\n    _this.userInfo = {};\n    _this.roles = [];\n    _this.username = Cookies.get('username') || '';\n    return _this;\n  }\n\n  _createClass(User, [{\n    key: \"SET_TOKEN\",\n    value: function SET_TOKEN(token) {\n      this.token = token;\n    }\n  }, {\n    key: \"SET_NAME\",\n    value: function SET_NAME(name) {\n      this.name = name;\n    }\n  }, {\n    key: \"SET_USERINFO\",\n    value: function SET_USERINFO(userInfo) {\n      this.userInfo = _objectSpread({}, userInfo);\n    }\n  }, {\n    key: \"SET_AVATAR\",\n    value: function SET_AVATAR(avatar) {\n      this.avatar = avatar;\n    }\n  }, {\n    key: \"SET_INTRODUCTION\",\n    value: function SET_INTRODUCTION(introduction) {\n      this.introduction = introduction;\n    }\n  }, {\n    key: \"SET_ROLES\",\n    value: function SET_ROLES(roles) {\n      this.roles = roles;\n    }\n  }, {\n    key: \"SET_STOREID\",\n    value: function SET_STOREID(storeId) {\n      this.storeId = storeId;\n    }\n  }, {\n    key: \"SET_USERNAME\",\n    value: function SET_USERNAME(name) {\n      this.username = name;\n    }\n  }, {\n    key: \"Login\",\n    value: function () {\n      var _Login = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(userInfo) {\n        var username, password, _ref, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                username = userInfo.username, password = userInfo.password;\n                username = username.trim();\n                this.SET_USERNAME(username);\n                Cookies.set('username', username);\n                _context.next = 6;\n                return login({\n                  username: username,\n                  password: password\n                });\n\n              case 6:\n                _ref = _context.sent;\n                data = _ref.data;\n\n                if (!(String(data.code) === '1')) {\n                  _context.next = 16;\n                  break;\n                }\n\n                // const dataParams = {\n                //   // status: 200,\n                //   token: data.data.token,\n                //   // msg: '登录成功',\n                //   // ...data.data\n                //   ...data\n                // }\n                this.SET_TOKEN(data.data.token);\n                setToken(data.data.token);\n                this.SET_USERINFO(data.data);\n                Cookies.set('user_info', data.data);\n                return _context.abrupt(\"return\", data);\n\n              case 16:\n                return _context.abrupt(\"return\", Message.error(data.msg));\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function Login(_x) {\n        return _Login.apply(this, arguments);\n      }\n\n      return Login;\n    }()\n  }, {\n    key: \"ResetToken\",\n    value: function ResetToken() {\n      removeToken();\n      this.SET_TOKEN('');\n      this.SET_ROLES([]);\n    }\n  }, {\n    key: \"changeStore\",\n    value: function () {\n      var _changeStore = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(data) {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.SET_STOREID = data.data;\n                this.SET_TOKEN(data.authorization);\n                setStoreId(data.data);\n                setToken(data.authorization);\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function changeStore(_x2) {\n        return _changeStore.apply(this, arguments);\n      }\n\n      return changeStore;\n    }()\n  }, {\n    key: \"GetUserInfo\",\n    value: function () {\n      var _GetUserInfo = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var data, roles, name, avatar, introduction, applicant, storeManagerName, _data$storeId, storeId;\n\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(this.token === '')) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                throw Error('GetUserInfo: token is undefined!');\n\n              case 2:\n                data = JSON.parse(getUserInfo()); //  { roles: ['admin'], name: 'zhangsan', avatar: '/login', introduction: '' }\n\n                if (data) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                throw Error('Verification failed, please Login again.');\n\n              case 5:\n                roles = data.roles, name = data.name, avatar = data.avatar, introduction = data.introduction, applicant = data.applicant, storeManagerName = data.storeManagerName, _data$storeId = data.storeId, storeId = _data$storeId === void 0 ? '' : _data$storeId; // data.user\n                // roles must be a non-empty array\n\n                if (!(!roles || roles.length <= 0)) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                throw Error('GetUserInfo: roles must be a non-null array!');\n\n              case 8:\n                this.SET_ROLES(roles);\n                this.SET_USERINFO(data);\n                this.SET_NAME(name || applicant || storeManagerName);\n                this.SET_AVATAR(avatar);\n                this.SET_INTRODUCTION(introduction);\n\n              case 13:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function GetUserInfo() {\n        return _GetUserInfo.apply(this, arguments);\n      }\n\n      return GetUserInfo;\n    }()\n  }, {\n    key: \"LogOut\",\n    value: function () {\n      var _LogOut = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4() {\n        var _ref2, data;\n\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return userLogout({});\n\n              case 2:\n                _ref2 = _context4.sent;\n                data = _ref2.data;\n                removeToken();\n                this.SET_TOKEN('');\n                this.SET_ROLES([]);\n                Cookies.remove('username');\n                Cookies.remove('user_info');\n                removeUserInfo();\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function LogOut() {\n        return _LogOut.apply(this, arguments);\n      }\n\n      return LogOut;\n    }()\n  }]);\n\n  return User;\n}(VuexModule);\n\n__decorate([Mutation], User.prototype, \"SET_TOKEN\", null);\n\n__decorate([Mutation], User.prototype, \"SET_NAME\", null);\n\n__decorate([Mutation], User.prototype, \"SET_USERINFO\", null);\n\n__decorate([Mutation], User.prototype, \"SET_AVATAR\", null);\n\n__decorate([Mutation], User.prototype, \"SET_INTRODUCTION\", null);\n\n__decorate([Mutation], User.prototype, \"SET_ROLES\", null);\n\n__decorate([Mutation], User.prototype, \"SET_STOREID\", null);\n\n__decorate([Mutation], User.prototype, \"SET_USERNAME\", null);\n\n__decorate([Action], User.prototype, \"Login\", null);\n\n__decorate([Action], User.prototype, \"ResetToken\", null);\n\n__decorate([Action], User.prototype, \"changeStore\", null);\n\n__decorate([Action], User.prototype, \"GetUserInfo\", null);\n\n__decorate([Action], User.prototype, \"LogOut\", null);\n\nUser = __decorate([Module({\n  'dynamic': true,\n  store: store,\n  'name': 'user'\n})], User);\nexport var UserModule = getModule(User);",{"version":3,"sources":["G:\\sky\\project-sky-admin-vue-ts\\src\\store\\modules\\user.ts"],"names":[],"mappings":"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","sourcesContent":["import { VuexModule, Module, Action, Mutation, getModule } from 'vuex-module-decorators'\r\nimport { login,userLogout } from '@/api/employee'\r\nimport { getToken, setToken, removeToken,getStoreId, setStoreId, removeStoreId, setUserInfo, getUserInfo, removeUserInfo } from '@/utils/cookies'\r\nimport store from '@/store'\r\nimport Cookies from 'js-cookie'\r\nimport { Message } from 'element-ui'\r\nexport interface IUserState {\r\n  token: string\r\n  name: string\r\n  avatar: string\r\n  storeId: string\r\n  introduction: string\r\n  userInfo: any\r\n  roles: string[]\r\n  username: string\r\n}\r\n\r\n@Module({ 'dynamic': true, store, 'name': 'user' })\r\nclass User extends VuexModule implements IUserState {\r\n  public token = getToken() || ''\r\n  public name = ''\r\n  public avatar = ''\r\n  // @ts-ignore\r\n  public storeId: string = getStoreId() || ''\r\n  public introduction = ''\r\n  public userInfo = {}\r\n  public roles: string[] = []\r\n  public username = Cookies.get('username') || ''\r\n\r\n  @Mutation\r\n  private SET_TOKEN(token: string) {\r\n    this.token = token\r\n  }\r\n\r\n  @Mutation\r\n  private SET_NAME(name: string) {\r\n    this.name = name\r\n  }\r\n\r\n  @Mutation\r\n  private SET_USERINFO(userInfo: any) {\r\n    this.userInfo = { ...userInfo }\r\n  }\r\n\r\n  @Mutation\r\n  private SET_AVATAR(avatar: string) {\r\n    this.avatar = avatar\r\n  }\r\n\r\n  @Mutation\r\n  private SET_INTRODUCTION(introduction: string) {\r\n    this.introduction = introduction\r\n  }\r\n\r\n  @Mutation\r\n  private SET_ROLES(roles: string[]) {\r\n    this.roles = roles\r\n  }\r\n\r\n  @Mutation\r\n  private SET_STOREID(storeId: string) {\r\n    this.storeId = storeId\r\n  }\r\n  @Mutation\r\n  private SET_USERNAME(name: string) {\r\n    this.username = name\r\n    }\r\n\r\n  @Action\r\n  public async Login(userInfo: { username: string, password: string }) {\r\n    let { username, password } = userInfo\r\n    username = username.trim()\r\n    this.SET_USERNAME(username)\r\n    Cookies.set('username', username)\r\n    const { data } = await login({ username, password })\r\n    if (String(data.code) === '1') {\r\n      // const dataParams = {\r\n      //   // status: 200,\r\n      //   token: data.data.token,\r\n      //   // msg: '登录成功',\r\n      //   // ...data.data\r\n      //   ...data\r\n      // }\r\n      this.SET_TOKEN(data.data.token)\r\n      setToken(data.data.token)\r\n      this.SET_USERINFO(data.data)\r\n      Cookies.set('user_info', data.data)\r\n      return data\r\n    } else {\r\n      return Message.error(data.msg)\r\n    }\r\n  }\r\n\r\n  @Action\r\n  public ResetToken () {\r\n    removeToken()\r\n    this.SET_TOKEN('')\r\n    this.SET_ROLES([])\r\n  }\r\n\r\n  @Action\r\n  public async changeStore(data: any) {\r\n    this.SET_STOREID = data.data\r\n    this.SET_TOKEN(data.authorization)\r\n    setStoreId(data.data)\r\n    setToken(data.authorization)\r\n  }\r\n\r\n  @Action\r\n  public async GetUserInfo () {\r\n    if (this.token === '') {\r\n      throw Error('GetUserInfo: token is undefined!')\r\n    }\r\n\r\n    const data = JSON.parse(<string>getUserInfo()) //  { roles: ['admin'], name: 'zhangsan', avatar: '/login', introduction: '' }\r\n    if (!data) {\r\n      throw Error('Verification failed, please Login again.')\r\n    }\r\n\r\n    const { roles, name, avatar, introduction, applicant, storeManagerName, storeId='' } = data // data.user\r\n    // roles must be a non-empty array\r\n    if (!roles || roles.length <= 0) {\r\n      throw Error('GetUserInfo: roles must be a non-null array!')\r\n    }\r\n\r\n    this.SET_ROLES(roles)\r\n    this.SET_USERINFO(data)\r\n    this.SET_NAME(name || applicant || storeManagerName)\r\n    this.SET_AVATAR(avatar)\r\n    this.SET_INTRODUCTION(introduction)\r\n  }\r\n\r\n  @Action\r\n  public async LogOut () {\r\n    const { data } = await userLogout({})\r\n    removeToken()\r\n    this.SET_TOKEN('')\r\n    this.SET_ROLES([])\r\n    Cookies.remove('username')\r\n    Cookies.remove('user_info')\r\n    removeUserInfo()\r\n  }\r\n}\r\n\r\nexport const UserModule = getModule(User)\r\n"],"sourceRoot":""}]}