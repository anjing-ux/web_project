{"remainingRequest":"G:\\device-management\\project-sky-admin-vue-ts\\node_modules\\babel-loader\\lib\\index.js!G:\\device-management\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!G:\\device-management\\project-sky-admin-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\device-management\\project-sky-admin-vue-ts\\src\\views\\teamLeader\\deviceReview\\inspectionAcceptance\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\device-management\\project-sky-admin-vue-ts\\src\\views\\teamLeader\\deviceReview\\inspectionAcceptance\\index.vue","mtime":1747310473446},{"path":"G:\\device-management\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\device-management\\project-sky-admin-vue-ts\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"G:\\device-management\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\device-management\\project-sky-admin-vue-ts\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"G:\\\\device-management\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"G:\\\\device-management\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/defineProperty\"));\n\nrequire(\"core-js/modules/es6.array.find\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"G:\\\\device-management\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/asyncToGenerator\"));\n\nvar _TabChange = _interopRequireDefault(require(\"@/components/TabChange\"));\n\nvar _Empty = _interopRequireDefault(require(\"@/components/Empty\"));\n\nvar _inspection = require(\"@/api/inspection\");\n\nvar _elementUi = require(\"element-ui\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar _default = {\n  name: 'InspectionAcceptance',\n  components: {\n    TabChange: _TabChange.default,\n    Empty: _Empty.default\n  },\n  data: function data() {\n    return {\n      deviceName: '',\n      taskName: '',\n      valueTime: '',\n      tableData: [],\n      counts: 0,\n      page: 1,\n      pageSize: 10,\n      isSearch: false,\n      inspectionStatus: 2,\n      // 默认显示待验收状态\n      dialogVisible: false,\n      acceptDialogVisible: false,\n      acceptResult: 1,\n      remark: '',\n      diaForm: {},\n      dialogInspectionStatus: null,\n      row: null,\n      orderStatics: [{\n        name: '全部',\n        value: -1\n      }, {\n        name: '待执行',\n        value: 0\n      }, {\n        name: '执行中',\n        value: 1\n      }, {\n        name: '待验收',\n        value: 2\n      }, {\n        name: '已验收',\n        value: 3\n      }, {\n        name: '已关闭',\n        value: 4\n      }],\n      inspectionStatusList: [{\n        label: '待执行',\n        value: 0\n      }, {\n        label: '执行中',\n        value: 1\n      }, {\n        label: '待验收',\n        value: 2\n      }, {\n        label: '已验收',\n        value: 3\n      }, {\n        label: '已关闭',\n        value: 4\n      }],\n      defaultActivity: '2'\n    };\n  },\n  created: function created() {\n    this.init(this.inspectionStatus);\n  },\n  methods: {\n    // 初始化数据\n    init: function () {\n      var _init = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(status) {\n        var isSearch,\n            params,\n            res,\n            _args = arguments;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                isSearch = _args.length > 1 && _args[1] !== undefined ? _args[1] : false;\n                this.inspectionStatus = status;\n                this.isSearch = isSearch;\n                params = {\n                  page: this.page,\n                  pageSize: this.pageSize,\n                  status: this.inspectionStatus === -1 ? null : this.inspectionStatus\n                };\n\n                if (this.deviceName) {\n                  params.deviceName = this.deviceName;\n                }\n\n                if (this.taskName) {\n                  params.taskName = this.taskName;\n                }\n\n                if (this.valueTime && this.valueTime.length) {\n                  params.beginTime = this.valueTime[0];\n                  params.endTime = this.valueTime[1];\n                }\n\n                _context.prev = 7;\n                _context.next = 10;\n                return (0, _inspection.getInspectionTaskList)(params);\n\n              case 10:\n                res = _context.sent;\n\n                if (res.code === 1) {\n                  this.tableData = res.data.records || [];\n                  this.counts = res.data.total;\n                }\n\n                _context.next = 17;\n                break;\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](7);\n                console.error(_context.t0);\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[7, 14]]);\n      }));\n\n      function init(_x) {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    // 回车触发查询\n    initFun: function initFun(status) {\n      this.init(status, true);\n    },\n    // 切换tab\n    change: function change(status) {\n      this.inspectionStatus = status;\n      this.init(status);\n    },\n    // 获取巡检状态文本\n    getInspectionStatus: function getInspectionStatus(row) {\n      var status = this.inspectionStatusList.find(function (item) {\n        return item.value === row.status;\n      });\n      return status ? status.label : '未知状态';\n    },\n    // 查看详情\n    goDetail: function goDetail(taskCode, status, row) {\n      this.dialogVisible = true;\n      this.dialogInspectionStatus = status;\n      this.row = row;\n      this.diaForm = _objectSpread({}, row);\n    },\n    // 关闭弹窗\n    handleClose: function handleClose() {\n      this.dialogVisible = false;\n    },\n    // 验收任务\n    acceptInspection: function acceptInspection(row) {\n      this.row = row;\n      this.acceptDialogVisible = true;\n    },\n    // 确认验收\n    confirmAccept: function () {\n      var _confirmAccept = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var params, res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.remark.trim()) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                _elementUi.Message.warning('请填写验收备注');\n\n                return _context2.abrupt(\"return\");\n\n              case 3:\n                _context2.prev = 3;\n                params = {\n                  taskId: this.row.taskId,\n                  status: this.acceptResult === 1 ? 3 : 2,\n                  // 通过设为已验收，不通过保持待验收\n                  remark: this.remark\n                };\n                _context2.next = 7;\n                return (0, _inspection.acceptInspectionTask)(params);\n\n              case 7:\n                res = _context2.sent;\n\n                if (res.code === 1) {\n                  _elementUi.Message.success('验收操作成功');\n\n                  this.acceptDialogVisible = false;\n                  this.init(this.inspectionStatus);\n                } else {\n                  _elementUi.Message.error(res.msg || '验收操作失败');\n                }\n\n                _context2.next = 15;\n                break;\n\n              case 11:\n                _context2.prev = 11;\n                _context2.t0 = _context2[\"catch\"](3);\n                console.error(_context2.t0);\n\n                _elementUi.Message.error('验收操作失败');\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[3, 11]]);\n      }));\n\n      function confirmAccept() {\n        return _confirmAccept.apply(this, arguments);\n      }\n\n      return confirmAccept;\n    }(),\n    // 创建巡检任务\n    addInspectionTask: function addInspectionTask() {\n      this.$router.push({\n        path: '/teamLeader/deviceReview/addInspectionTask'\n      });\n    },\n    // 分页相关方法\n    handleSizeChange: function handleSizeChange(val) {\n      this.pageSize = val;\n      this.init(this.inspectionStatus);\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.page = val;\n      this.init(this.inspectionStatus);\n    }\n  }\n};\nexports.default = _default;",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"dashboard-container\">\r\n    <TabChange :order-statics=\"orderStatics\" :default-activity=\"defaultActivity\" @tabChange=\"change\" />\r\n    <div class=\"container\" :class=\"{ hContainer: tableData.length }\">\r\n      <!-- 搜索项 -->\r\n      <div class=\"tableBar\">\r\n        <label style=\"margin-right: 10px\">设备名称：</label>\r\n        <el-input v-model=\"deviceName\" placeholder=\"请填写设备名称：\" style=\"width: 15%\" clearable\r\n          @clear=\"init(inspectionStatus)\" @keyup.enter.native=\"initFun(inspectionStatus)\" />\r\n        <label style=\"margin-right: 10px; margin-left: 20px\">任务名称：</label>\r\n        <el-input v-model=\"taskName\" placeholder=\"请填写任务名称：\" style=\"width: 15%\" clearable\r\n          @clear=\"init(inspectionStatus)\" @keyup.enter.native=\"initFun(inspectionStatus)\" />\r\n        <label style=\"margin-left: 20px\">开始时间：</label>\r\n        <el-date-picker v-model=\"valueTime\" clearable value-format=\"yyyy-MM-dd HH:mm:ss\" range-separator=\"至\"\r\n          :default-time=\"['00:00:00', '23:59:59']\" type=\"daterange\" start-placeholder=\"开始日期\" end-placeholder=\"结束日期\"\r\n          style=\"width: 25%; margin-left: 10px\" @clear=\"init(inspectionStatus)\" />\r\n        <el-button class=\"normal-btn continue\" @click=\"init(inspectionStatus, true)\">\r\n          查询\r\n        </el-button>\r\n        <el-button type=\"primary\" style=\"margin-left: 120px\" @click=\"addInspectionTask\">\r\n          创建巡检任务\r\n        </el-button>\r\n      </div>\r\n      <el-table v-if=\"tableData.length\" :data=\"tableData\" stripe class=\"tableBox\">\r\n        <el-table-column key=\"taskCode\" prop=\"taskCode\" label=\"任务编号\" />\r\n        <el-table-column key=\"deviceName\" prop=\"deviceName\" label=\"设备名称\" />\r\n        <el-table-column key=\"taskName\" prop=\"taskName\" label=\"任务名称\" />\r\n        <el-table-column v-if=\"[-1].includes(inspectionStatus)\" key=\"status\" prop=\"status\" label=\"状态信息\">\r\n          <template slot-scope=\"{ row }\">\r\n            <span>{{ getInspectionStatus(row) }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column key=\"startTime\" prop=\"startTime\" label=\"开始时间\" />\r\n        <el-table-column key=\"endTime\" prop=\"endTime\" label=\"结束时间\" />\r\n        <el-table-column key=\"executorName\" prop=\"executorName\" label=\"执行人姓名\" />\r\n        <el-table-column v-if=\"[1].includes(inspectionStatus)\" key=\"processTime\" prop=\"processTime\" label=\"接单时间\" />\r\n        <el-table-column v-if=\"[2, 3].includes(inspectionStatus)\" key=\"completeTime\" prop=\"completeTime\" label=\"完成时间\" />\r\n        <el-table-column v-if=\"[4].includes(inspectionStatus)\" key=\"closeTime\" prop=\"closeTime\" label=\"关闭时间\" />\r\n        <el-table-column prop=\"btn\" label=\"操作\" align=\"center\"\r\n          :class-name=\"inspectionStatus === 0 ? 'operate' : 'otherOperate'\" :min-width=\"[-1, 0].includes(inspectionStatus)\r\n            ? 130\r\n            : [1, 2].includes(inspectionStatus)\r\n              ? 140\r\n              : 'auto'\r\n            \">\r\n          <template slot-scope=\"{ row }\">\r\n            <div class=\"before\">\r\n              <el-button v-if=\"[2].includes(row.status)\" type=\"text\" class=\"delBut\" @click=\"acceptInspection(row)\">\r\n                验收\r\n              </el-button>\r\n            </div>\r\n            <div class=\"after\">\r\n              <el-button type=\"text\" class=\"blueBug non\" @click=\"goDetail(row.taskCode, row.status, row)\">\r\n                查看\r\n              </el-button>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <Empty v-else :is-search=\"isSearch\" />\r\n      <el-pagination v-if=\"counts > 10\" class=\"pageList\" :page-sizes=\"[10, 20, 30, 40]\" :page-size=\"pageSize\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\" :total=\"counts\" @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\" />\r\n    </div>\r\n\r\n    <!-- 查看弹框部分 -->\r\n    <el-dialog title=\"巡检任务详细信息\" :visible.sync=\"dialogVisible\" width=\"53%\" :before-close=\"handleClose\"\r\n      class=\"order-dialog\">\r\n      <el-scrollbar style=\"height: 100%\">\r\n        <!-- 顶部信息 -->\r\n        <div class=\"order-top\">\r\n          <div>\r\n            <div style=\"display: inline-block\">\r\n              <label style=\"font-size: 16px\">任务编号：</label>\r\n              <div class=\"order-num\">\r\n                {{ diaForm.taskCode }}\r\n              </div>\r\n            </div>\r\n            <div style=\"display: inline-block\" class=\"order-status\" :class=\"{ status3: true }\">\r\n              {{\r\n                inspectionStatusList.filter((item) => item.value === dialogInspectionStatus).length > 0 \r\n                ? inspectionStatusList.filter((item) => item.value === dialogInspectionStatus)[0].label \r\n                : '未知状态'\r\n              }}\r\n            </div>\r\n          </div>\r\n          <p><label>创建时间：</label>{{ diaForm.createTime }}</p>\r\n        </div>\r\n\r\n        <!-- 中间信息 -->\r\n        <div class=\"order-middle\">\r\n          <!-- 巡检任务信息 -->\r\n          <div class=\"dish-label\">巡检任务信息</div>\r\n          <div class=\"user-info\">\r\n            <div class=\"user-info-box\">\r\n              <div class=\"user-name\">\r\n                <label>任务名称：</label>\r\n                <span>{{ diaForm.taskName }}</span>\r\n              </div>\r\n\r\n              <div class=\"user-getTime\">\r\n                <label>开始时间：</label>\r\n                <span>{{ diaForm.startTime }}</span>\r\n              </div>\r\n\r\n              <div class=\"user-getTime\">\r\n                <label>结束时间：</label>\r\n                <span>{{ diaForm.endTime }}</span>\r\n              </div>\r\n\r\n              <div class=\"user-name\">\r\n                <label>执行人姓名：</label>\r\n                <span>{{ diaForm.executorName }}</span>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"user-remark\">\r\n              <div>巡检项点：</div>\r\n              <span>{{ diaForm.inspectionItems }}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"dish-label\">设备信息</div>\r\n          <!-- 设备信息 -->\r\n          <div class=\"user-info\">\r\n            <div class=\"user-info-box\">\r\n              <div class=\"user-name\">\r\n                <label>设备编号：</label>\r\n                <span>{{ diaForm.deviceCode }}</span>\r\n              </div>\r\n\r\n              <div class=\"user-name\">\r\n                <label>设备名称：</label>\r\n                <span>{{ diaForm.deviceName }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 底部信息 -->\r\n        <div class=\"order-bottom\">\r\n          <div class=\"amount-label\">执行信息</div>\r\n          <div class=\"amount-info\">\r\n            <div class=\"user-remark\">\r\n              <div class=\"approver-time\">\r\n                <div>执行人：</div>\r\n                <span>{{ diaForm.executorName }}</span>\r\n              </div>\r\n              <div class=\"approver-time\">\r\n                <div>接单时间：</div>\r\n                <span>{{ diaForm.processTime }}</span>\r\n              </div>\r\n              <div class=\"approver-time\">\r\n                <div>完成时间：</div>\r\n                <span>{{ diaForm.completeTime }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </el-scrollbar>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">返 回</el-button>\r\n        <el-button v-if=\"[2].includes(dialogInspectionStatus)\" type=\"primary\"\r\n          @click=\"acceptInspection(row)\">验收</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    \r\n    <!-- 验收确认弹窗 -->\r\n    <el-dialog title=\"验收确认\" :visible.sync=\"acceptDialogVisible\" width=\"42%\"\r\n      :before-close=\"() => ((acceptDialogVisible = false), (remark = ''))\" class=\"cancelDialog\">\r\n      <el-form label-width=\"90px\">\r\n        <el-form-item label=\"验收结果：\">\r\n          <el-radio-group v-model=\"acceptResult\">\r\n            <el-radio :label=\"1\">通过</el-radio>\r\n            <el-radio :label=\"0\">不通过</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"验收备注：\">\r\n          <el-input v-model.trim=\"remark\" type=\"textarea\" placeholder=\"请填写验收备注（限50字内）\" maxlength=\"50\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"acceptDialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"confirmAccept\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport TabChange from '@/components/TabChange'\r\nimport Empty from '@/components/Empty'\r\nimport { getInspectionTaskList, acceptInspectionTask } from '@/api/inspection'\r\nimport { Message } from 'element-ui'\r\n\r\nexport default {\r\n  name: 'InspectionAcceptance',\r\n  components: {\r\n    TabChange,\r\n    Empty\r\n  },\r\n  data() {\r\n    return {\r\n      deviceName: '',\r\n      taskName: '',\r\n      valueTime: '',\r\n      tableData: [],\r\n      counts: 0,\r\n      page: 1,\r\n      pageSize: 10,\r\n      isSearch: false,\r\n      inspectionStatus: 2, // 默认显示待验收状态\r\n      dialogVisible: false,\r\n      acceptDialogVisible: false,\r\n      acceptResult: 1,\r\n      remark: '',\r\n      diaForm: {},\r\n      dialogInspectionStatus: null,\r\n      row: null,\r\n      orderStatics: [\r\n        { name: '全部', value: -1 },\r\n        { name: '待执行', value: 0 },\r\n        { name: '执行中', value: 1 },\r\n        { name: '待验收', value: 2 },\r\n        { name: '已验收', value: 3 },\r\n        { name: '已关闭', value: 4 }\r\n      ],\r\n      inspectionStatusList: [\r\n        { label: '待执行', value: 0 },\r\n        { label: '执行中', value: 1 },\r\n        { label: '待验收', value: 2 },\r\n        { label: '已验收', value: 3 },\r\n        { label: '已关闭', value: 4 }\r\n      ],\r\n      defaultActivity: '2'\r\n    }\r\n  },\r\n  created() {\r\n    this.init(this.inspectionStatus)\r\n  },\r\n  methods: {\r\n    // 初始化数据\r\n    async init(status, isSearch = false) {\r\n      this.inspectionStatus = status\r\n      this.isSearch = isSearch\r\n      const params = {\r\n        page: this.page,\r\n        pageSize: this.pageSize,\r\n        status: this.inspectionStatus === -1 ? null : this.inspectionStatus\r\n      }\r\n      if (this.deviceName) {\r\n        params.deviceName = this.deviceName\r\n      }\r\n      if (this.taskName) {\r\n        params.taskName = this.taskName\r\n      }\r\n      if (this.valueTime && this.valueTime.length) {\r\n        params.beginTime = this.valueTime[0]\r\n        params.endTime = this.valueTime[1]\r\n      }\r\n      try {\r\n        const res = await getInspectionTaskList(params)\r\n        if (res.code === 1) {\r\n          this.tableData = res.data.records || []\r\n          this.counts = res.data.total\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    // 回车触发查询\r\n    initFun(status) {\r\n      this.init(status, true)\r\n    },\r\n    // 切换tab\r\n    change(status) {\r\n      this.inspectionStatus = status\r\n      this.init(status)\r\n    },\r\n    // 获取巡检状态文本\r\n    getInspectionStatus(row) {\r\n      const status = this.inspectionStatusList.find(item => item.value === row.status)\r\n      return status ? status.label : '未知状态'\r\n    },\r\n    // 查看详情\r\n    goDetail(taskCode, status, row) {\r\n      this.dialogVisible = true\r\n      this.dialogInspectionStatus = status\r\n      this.row = row\r\n      this.diaForm = { ...row }\r\n    },\r\n    // 关闭弹窗\r\n    handleClose() {\r\n      this.dialogVisible = false\r\n    },\r\n    // 验收任务\r\n    acceptInspection(row) {\r\n      this.row = row\r\n      this.acceptDialogVisible = true\r\n    },\r\n    // 确认验收\r\n    async confirmAccept() {\r\n      if (!this.remark.trim()) {\r\n        Message.warning('请填写验收备注')\r\n        return\r\n      }\r\n      try {\r\n        const params = {\r\n          taskId: this.row.taskId,\r\n          status: this.acceptResult === 1 ? 3 : 2, // 通过设为已验收，不通过保持待验收\r\n          remark: this.remark\r\n        }\r\n        const res = await acceptInspectionTask(params)\r\n        if (res.code === 1) {\r\n          Message.success('验收操作成功')\r\n          this.acceptDialogVisible = false\r\n          this.init(this.inspectionStatus)\r\n        } else {\r\n          Message.error(res.msg || '验收操作失败')\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n        Message.error('验收操作失败')\r\n      }\r\n    },\r\n    // 创建巡检任务\r\n    addInspectionTask() {\r\n      this.$router.push({ path: '/teamLeader/deviceReview/addInspectionTask' })\r\n    },\r\n    // 分页相关方法\r\n    handleSizeChange(val) {\r\n      this.pageSize = val\r\n      this.init(this.inspectionStatus)\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.page = val\r\n      this.init(this.inspectionStatus)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.dashboard {\r\n  &-container {\r\n    margin: 30px;\r\n    // height: 100%;\r\n    min-height: 700px;\r\n\r\n    .container {\r\n      background: #fff;\r\n      position: relative;\r\n      z-index: 1;\r\n      padding: 30px 28px;\r\n      border-radius: 4px;\r\n      // min-height: 650px;\r\n      height: calc(100% - 55px);\r\n\r\n      .tableBar {\r\n        // display: flex;\r\n        margin-bottom: 20px;\r\n        justify-content: space-between;\r\n\r\n        .tableLab {\r\n          span {\r\n            cursor: pointer;\r\n            display: inline-block;\r\n            font-size: 14px;\r\n            padding: 0 20px;\r\n            color: $gray-2;\r\n            border-right: solid 1px $gray-4;\r\n          }\r\n        }\r\n      }\r\n\r\n      .tableBox {\r\n        width: 100%;\r\n        border: 1px solid $gray-5;\r\n        border-bottom: 0;\r\n      }\r\n\r\n      .pageList {\r\n        text-align: center;\r\n        margin-top: 30px;\r\n      }\r\n\r\n      //查询黑色按钮样式\r\n      .normal-btn {\r\n        background: #333333;\r\n        color: white;\r\n        margin-left: 20px;\r\n      }\r\n    }\r\n\r\n    .hContainer {\r\n      height: auto !important;\r\n    }\r\n  }\r\n}\r\n\r\n.search-btn {\r\n  margin-left: 20px;\r\n}\r\n\r\n.info-box {\r\n  margin: -15px -44px 20px;\r\n\r\n  p {\r\n    display: flex;\r\n    height: 20px;\r\n    line-height: 20px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: #666666;\r\n    text-align: left;\r\n    margin-bottom: 14px;\r\n\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n\r\n    label {\r\n      width: 100px;\r\n      display: inline-block;\r\n      color: #666;\r\n    }\r\n\r\n    .des {\r\n      flex: 1;\r\n      color: #333333;\r\n    }\r\n  }\r\n}\r\n\r\n.order-top {\r\n  // height: 80px;\r\n  border-bottom: 1px solid #e7e6e6;\r\n  padding-bottom: 26px;\r\n  padding-left: 22px;\r\n  padding-right: 22px;\r\n  // margin: 0 30px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n\r\n  .order-status {\r\n    width: 57.25px;\r\n    height: 27px;\r\n    background: #333333;\r\n    border-radius: 13.5px;\r\n    color: white;\r\n    margin-left: 19px;\r\n    text-align: center;\r\n    line-height: 27px;\r\n  }\r\n\r\n  .status3 {\r\n    background: #f56c6c;\r\n  }\r\n\r\n  p {\r\n    color: #333;\r\n\r\n    label {\r\n      color: #666;\r\n    }\r\n  }\r\n\r\n  .order-num {\r\n    font-size: 16px;\r\n    color: #2a2929;\r\n    font-weight: bold;\r\n    display: inline-block;\r\n  }\r\n}\r\n\r\n.order-middle {\r\n  .user-info {\r\n    min-height: 140px;\r\n    background: #fbfbfa;\r\n    margin-top: 23px;\r\n\r\n    padding: 20px 43px;\r\n    color: #333;\r\n\r\n    .user-info-box {\r\n      min-height: 55px;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n\r\n      .user-name {\r\n        flex: 67%;\r\n      }\r\n\r\n      .user-phone {\r\n        flex: 33%;\r\n      }\r\n\r\n      .user-getTime {\r\n        margin-top: 14px;\r\n        flex: 80%;\r\n\r\n        label {\r\n          margin-right: 3px;\r\n        }\r\n      }\r\n\r\n      label {\r\n        margin-right: 17px;\r\n        color: #666;\r\n      }\r\n\r\n      .user-address {\r\n        margin-top: 14px;\r\n        flex: 80%;\r\n\r\n        label {\r\n          margin-right: 30px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .user-remark {\r\n      min-height: 43px;\r\n      line-height: 43px;\r\n      background: #fffbf0;\r\n      border: 1px solid #fbe396;\r\n      border-radius: 4px;\r\n      margin-top: 10px;\r\n      padding: 6px;\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      div {\r\n        display: inline-block;\r\n        min-width: 53px;\r\n        height: 32px;\r\n        background: #fbe396;\r\n        border-radius: 4px;\r\n        text-align: center;\r\n        line-height: 32px;\r\n        color: #333;\r\n        margin-right: 30px;\r\n        // padding: 12px 6px;\r\n      }\r\n\r\n      span {\r\n        color: #f2a402;\r\n        line-height: 1.15;\r\n      }\r\n    }\r\n\r\n    .orderCancel {\r\n      background: #ffffff;\r\n      border: 1px solid #b6b6b6;\r\n\r\n      div {\r\n        padding: 0 10px;\r\n        background-color: #e5e4e4;\r\n      }\r\n\r\n      span {\r\n        color: #f56c6c;\r\n      }\r\n    }\r\n  }\r\n\r\n  .dish-info {\r\n    // min-height: 180px;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    padding: 20px 40px;\r\n    border-bottom: 1px solid #e7e6e6;\r\n\r\n    .dish-label {\r\n      color: #666;\r\n    }\r\n\r\n    .dish-list {\r\n      flex: 80%;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n\r\n      .dish-item {\r\n        flex: 50%;\r\n        margin-bottom: 14px;\r\n        color: #333;\r\n\r\n        .dish-num {}\r\n\r\n        .dish-item-box {\r\n          display: inline-block;\r\n          width: 120px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .dish-label {\r\n      margin-right: 65px;\r\n    }\r\n\r\n    .dish-all-amount {\r\n      flex: 1;\r\n      padding-left: 92px;\r\n      margin-top: 10px;\r\n\r\n      label {\r\n        color: #333333;\r\n        font-weight: bold;\r\n        margin-right: 5px;\r\n      }\r\n\r\n      span {\r\n        color: #f56c6c;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.order-bottom {\r\n  .amount-info {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    padding: 20px 40px;\r\n    padding-bottom: 0px;\r\n\r\n    .amount-label {\r\n      color: #666;\r\n      margin-right: 65px;\r\n    }\r\n\r\n    .user-remark {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      margin-bottom: 20px;\r\n\r\n      .approver-time {\r\n        display: flex;\r\n        align-items: center;\r\n        margin-right: 20px;\r\n\r\n        div {\r\n          margin-right: 5px;\r\n        }\r\n\r\n        span {\r\n          color: #333;\r\n        }\r\n      }\r\n    }\r\n\r\n    .approval-comment {\r\n      width: 100%;\r\n      background: #fffbf0;\r\n      border: 1px solid #fbe396;\r\n      border-radius: 4px;\r\n      padding: 10px;\r\n      margin-top: 10px;\r\n\r\n      div {\r\n        display: inline-block;\r\n        margin-right: 10px;\r\n        color: #666;\r\n      }\r\n\r\n      span {\r\n        color: #333;\r\n        line-height: 1.5;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n.dashboard-container {\r\n  .cancelReason {\r\n    padding-left: 40px;\r\n  }\r\n\r\n  .cancelTime {\r\n    padding-left: 50px;\r\n  }\r\n\r\n  .orderTime {\r\n    padding-left: 50px;\r\n  }\r\n\r\n  td.operate .cell {\r\n\r\n    .before,\r\n    .middle,\r\n    .after {\r\n      height: 39px;\r\n      width: 48px;\r\n    }\r\n  }\r\n\r\n  td.operate .cell,\r\n  td.otherOperate .cell {\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    justify-content: center;\r\n  }\r\n\r\n  .order-dialog {\r\n    .el-dialog {\r\n      max-height: 764px !important;\r\n      display: flex;\r\n      flex-direction: column;\r\n      margin: 0 !important;\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n      max-height: calc(100% - 30px);\r\n      max-width: calc(100% - 30px);\r\n    }\r\n\r\n    .el-dialog__body {\r\n      height: 520px !important;\r\n    }\r\n  }\r\n}\r\n\r\n.el-dialog__body {\r\n  padding-top: 34px;\r\n  padding-left: 30px;\r\n  padding-right: 30px;\r\n}\r\n\r\n.cancelDialog {\r\n  .el-dialog__body {\r\n    padding-left: 64px;\r\n  }\r\n\r\n  .el-select,\r\n  .el-textarea {\r\n    width: 293px;\r\n  }\r\n\r\n  .el-textarea textarea {\r\n    height: 114px;\r\n  }\r\n}\r\n\r\n.el-dialog__footer {\r\n  .el-checkbox {\r\n    float: left;\r\n    margin-left: 40px;\r\n  }\r\n\r\n  .el-checkbox__label {\r\n    color: #333333 !important;\r\n  }\r\n}\r\n\r\n.empty-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n  img {\r\n    margin-top: 0 !important;\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/teamLeader/deviceReview/inspectionAcceptance"}]}